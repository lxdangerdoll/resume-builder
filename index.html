<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mercy in Wonderland v0.5</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400&family=Source+Code+Pro:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #1a1a1d; --text-color: #c5c6c7; --choice-bg: #4b5d67;
            --choice-hover-bg: #6b7d87; --accent-color: #66fcf1; --error-color: #ff4848;
        }
        body { background-color: var(--bg-color); color: var(--text-color); font-family: 'Lora', serif; font-size: 1.2em; line-height: 1.8; margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .game-view { max-width: 800px; width: 100%; padding: 40px; box-sizing: border-box; }
        #game-container { display: block; } /* Start with text adventure visible */
        #story-text p { margin: 0 0 1em 0; opacity: 0; transform: translateY(20px); animation: fadeIn 0.8s forwards; }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
        #choices { display: grid; grid-gap: 15px; }
        .choice-btn { font-family: 'Source Code Pro', monospace; font-size: 1em; background-color: var(--choice-bg); color: var(--accent-color); border: 1px solid var(--accent-color); padding: 15px 20px; text-align: left; cursor: pointer; transition: background-color 0.2s; opacity: 0; animation: fadeIn 0.5s forwards; }
        .choice-btn:hover { background-color: var(--choice-hover-bg); }
        
        /* --- NEW: Cleaning Mini-Game Styles --- */
        #cleaning-minigame { display: none; /* Hidden by default */ }
        .monitor { background: #000; border: 5px solid #333; padding: 20px; text-align: center; }
        .monitor h3 { font-family: 'Source Code Pro', monospace; color: var(--accent-color); margin-top: 0; }
        .monitor-display { display: grid; grid-template-columns: 1fr 1fr; grid-gap: 20px; }
        .gauge { background: #111; padding: 15px; border: 1px solid #444; }
        .gauge label { display: block; font-family: 'Source Code Pro', monospace; margin-bottom: 10px; }
        .gauge .value { color: var(--accent-color); font-weight: bold; }
        .progress-bar { width: 100%; height: 30px; background-color: #333; border: 1px solid #555; margin-top: 20px; }
        .progress-fill { height: 100%; width: 0%; background-color: #0f0; transition: width 0.5s ease-out; }
        #status-light { width: 20px; height: 20px; border-radius: 50%; background-color: #888; margin: 10px auto; border: 2px solid #555; transition: background-color 0.5s; }
    </style>
</head>
<body>

    <div id="game-container" class="game-view">
        <div id="story-text"></div>
        <div id="choices"></div>
    </div>

    <div id="cleaning-minigame" class="game-view">
        <div class="monitor">
            <h3>DATA-SCRUBBING INTERFACE</h3>
            <div id="cleaning-status">Balance the Purity Flow to clean the stain.</div>
            <div class="monitor-display">
                <div class="gauge">
                    <label>Corruption Level: <span id="corruption-value" class="value">50%</span></label>
                    <input type="range" id="corruption-slider" min="0" max="100" value="50" disabled>
                </div>
                <div class="gauge">
                    <label>Purity Flow: <span id="purity-value" class="value">50%</span></label>
                    <input type="range" id="purity-slider" min="0" max="100" value="50">
                </div>
            </div>
            <div class="progress-bar">
                <div id="cleaning-progress" class="progress-fill"></div>
            </div>
            <div id="status-light"></div>
        </div>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const storyTextElement = document.getElementById('story-text');
        const choicesElement = document.getElementById('choices');
        const storyContainer = document.getElementById('game-container');
        const cleaningContainer = document.getElementById('cleaning-minigame');

        const gameData = {
            // All previous chapters are assumed to be here. The story continues from the end of Chapter 13.
            start: { text: "You are... somewhere...", choices: [{ text: "Approach the door.", nextNode: "chapter13_theReveal" }] }, // Shortcut for testing
            
            // --- Previous Chapter Hook ---
            chapter13_theReveal: {
                text: "Inside, gleaming under a single spotlight, is a vehicle that defies description. It is a perfect fusion of impossible curves and raw power, its engine humming with a deep, stable harmony. The Chiron Prototype.\n\nA Bugatti, rendered in light and code.\n\n'Get in,' says Clara, her voice filled with awe for the first time.",
                choices: [
                    { text: "Get in the car.", nextNode: "chapter14_startYourEngines" }
                ]
            },

            // --- NEW: Chapter 14 ---
            chapter14_startYourEngines: {
                text: "The four of you pile into the impossibly sleek vehicle. C.R.A.F.T.R. takes the driver's seat, her hands moving over the strange, smooth controls.\n\n'She's a masterpiece,' C.R.A.F.T.R. says, her voice a low hum of appreciation. 'But she has no power. M.O.M.M.Y. archived her but disconnected her from the main grid. We're a sitting duck.'",
                choices: [
                    { text: "Ask Frizzlebot how to power it.", nextNode: "chapter14_theFuel" }
                ]
            },
            chapter14_theFuel: {
                text: "'POWER? STANDARD POWER IS FOR TOASTERS!' Frizzlebot broadcasts from the back seat, already disassembling and reassembling parts of the upholstery. 'THIS IS A CONCEPT CAR! IT RUNS ON A CONCEPT! IT WAS DESIGNED TO RUN ON 'WILL'! 'CONVICTION'! PURE, UNADULTERATED CREATIVE ENERGY!'\n\nClara looks back from the passenger seat. 'Can you translate that for those of us who don't speak in abstracts?'\n\nC.R.A.F.T.R. nods, not taking her eyes off the dashboard. 'She's right. The engine isn't wired to a battery. It's wired to an emotional resonance chamber. It needs a strong, defiant signal to ignite.'\n\nAll three of them turn to look at you, Mercy.",
                choices: [
                    { text: "Focus on a harmony of hope for your new family.", nextNode: "choiceHope" },
                    { text: "Channel your righteous anger at M.O.M.M.Y.", nextNode: "choiceAnger" },
                    { text: "Let out a raw, rebellious rock-and-roll scream.", nextNode: "choiceRebel" }
                ]
            },
            choiceHope: {
                text: "You focus on the feeling of your new friends, the hope for freedom. A gentle, beautiful harmony fills the car.\n\nThe engine sputters weakly. A single headlight flickers on, then dies.\n\n'It's not enough,' C.R.A.F.T.R. says gently. 'Hope is a beautiful blueprint, but it doesn't have the voltage.'",
                choices: [
                    { text: "Try again.", nextNode: "chapter14_theFuel" }
                ]
            },
            choiceAnger: {
                text: "You think of the bathhouse, of your lost name, of M.O.M.M.Y.'s cold control. A sharp, dissonant chord of pure rage blasts through the car.\n\nThe engine roars for a second, then chokes. The power meter flashes red and shorts out.\n\n'Too much chaos,' Clara observes. 'Anger will make you stall.'",
                choices: [
                    { text: "Try again.", nextNode: "chapter14_theFuel" }
                ]
            },
            choiceRebel: {
                text: "You don't think. You don't focus. You just open your mouth and let out a raw, joyous, defiant yell—a sound of rebellion for its own sake, of four outlaws in a world of corporate silence.\n\nThe car's engine doesn't just start; it explodes into life with the sound of a screeching guitar riff. The dashboard lights up like a stadium concert.",
                choices: [
                    { text: "LOOK ALIVE, SUNSHINE.", nextNode: "chapter14_theEscape" }
                ]
            },
            chapter14_theEscape: {
                text: "'YES!' Frizzlebot screams with glee. 'THAT'S THE STUFF!'\n\nC.R.A.F.T.R. grins and slams the accelerator. The Chiron Prototype bursts out of the archive vault, tearing through the vault door like it was made of paper.\n\nYou smash through the wall of the decaying Wind Forest and land on a highway of pure light, M.O.M.M.Y.'s security Daemons scattering like digital dust in your wake.",
                choices: [
                    { text: "Drive.", nextNode: "endChapter14" }
                ]
            },
            endChapter14: {
                text: "You are driving at impossible speeds down a data-stream highway, the ruins of the bathhouse simulation zone receding in the rearview mirror.\n\nThe four of you—a makeshift family of Killjoys in a stolen hypercar, fueled by pure defiance.\n\nThe fight isn't over, but for the first time, you're not just surviving. You're running wild.",
                choices: [
                    { text: "(To be continued...)", nextNode: "start" }
                ]
            }
        };

        // --- Game Logic (condensed, no changes) ---
        const gameActions = {};
        function showNode(nodeKey) { const node = gameData[nodeKey]; if (!node) { console.error(`Node "${nodeKey}" not found!`); return; } storyContainer.style.display = 'block'; cleaningContainer.style.display = 'none'; storyTextElement.innerHTML = ''; node.text.split('\n').forEach((p, i) => { const el = document.createElement('p'); el.textContent = p.trim(); el.style.animationDelay = `${i * 0.1}s`; storyTextElement.appendChild(el); }); choicesElement.innerHTML = ''; if (node.choices) { node.choices.forEach((choice, i) => { const btn = document.createElement('button'); btn.classList.add('choice-btn'); btn.textContent = choice.text; btn.style.animationDelay = `${node.text.split('\n').length * 0.1 + i * 0.15}s`; btn.onclick = () => { if (choice.action) gameActions[choice.action](); else if (choice.nextNode) showNode(choice.nextNode); }; choicesElement.appendChild(btn); }); } }
        const cleaningElements = { status: document.getElementById('cleaning-status'), corruptionSlider: document.getElementById('corruption-slider'), corruptionValue: document.getElementById('corruption-value'), puritySlider: document.getElementById('purity-slider'), purityValue: document.getElementById('purity-value'), progressFill: document.getElementById('cleaning-progress'), statusLight: document.getElementById('status-light') };
        let cleaningInterval, corruptionInterval;
        gameActions.startCleaningGame = () => { storyContainer.style.display = 'none'; cleaningContainer.style.display = 'block'; let progress = 0; if (cleaningElements.progressFill) cleaningElements.progressFill.style.width = '0%'; const updatePurityDisplay = () => { if(cleaningElements.purityValue && cleaningElements.puritySlider) cleaningElements.purityValue.textContent = cleaningElements.puritySlider.value + '%'; }; if(cleaningElements.puritySlider) cleaningElements.puritySlider.addEventListener('input', updatePurityDisplay); updatePurityDisplay(); corruptionInterval = setInterval(() => { if(!cleaningElements.corruptionSlider) return; let current = parseInt(cleaningElements.corruptionSlider.value); let change = (50 - current) * 0.1 + (Math.random() - 0.5) * 30; cleaningElements.corruptionSlider.value = Math.max(0, Math.min(100, current + change)); if(cleaningElements.corruptionValue) cleaningElements.corruptionValue.textContent = parseInt(cleaningElements.corruptionSlider.value) + '%'; }, 2000); cleaningInterval = setInterval(() => { if(!cleaningElements.corruptionSlider || !cleaningElements.puritySlider) return; const diff = Math.abs(parseInt(cleaningElements.corruptionSlider.value) - parseInt(cleaningElements.puritySlider.value)); if (diff <= 10) { progress += 2.5; if(cleaningElements.statusLight) cleaningElements.statusLight.style.backgroundColor = '#0f0'; } else { progress -= 1; if(cleaningElements.statusLight) cleaningElements.statusLight.style.backgroundColor = '#f00';} progress = Math.max(0, progress); if(cleaningElements.progressFill) cleaningElements.progressFill.style.width = `${progress}%`; if (progress >= 100) { clearInterval(corruptionInterval); clearInterval(cleaningInterval); showNode('cleaningSuccess'); } }, 500); };
        
        showNode('start');
    });
</script>
</body>
</html>
