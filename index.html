<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mercy in Wonderland</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400&family=Source+Code+Pro:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #1a1a1d;
            --text-color: #c5c6c7;
            --choice-bg: #4b5d67;
            --choice-hover-bg: #6b7d87;
            --accent-color: #66fcf1;
        }
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Lora', serif;
            font-size: 1.2em;
            line-height: 1.8;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        #game-container {
            max-width: 800px;
            width: 100%;
            padding: 40px;
            box-sizing: border-box;
        }
        #story-text {
            margin-bottom: 40px;
            white-space: pre-wrap; /* Preserves line breaks in the text */
        }
        #story-text p {
            margin: 0 0 1em 0;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.8s forwards;
        }
        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        #choices {
            display: grid;
            grid-gap: 15px;
        }
        .choice-btn {
            font-family: 'Source Code Pro', monospace;
            font-size: 1em;
            background-color: var(--choice-bg);
            color: var(--accent-color);
            border: 1px solid var(--accent-color);
            padding: 15px 20px;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.2s;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
        }
        .choice-btn:hover {
            background-color: var(--choice-hover-bg);
        }
        .choice-btn:focus {
            outline: 2px solid var(--accent-color);
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="story-text"></div>
        <div id="choices"></div>
    </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const storyTextElement = document.getElementById('story-text');
        const choicesElement = document.getElementById('choices');

        const gameData = {
            start: {
                text: "You are... somewhere.\nThe air hums with a silent static...",
                choices: [
                    { text: "Approach the left door.", nextNode: "twoDoorsRoom" },
                    { text: "Approach the right door.", nextNode: "twoDoorsRoom" }
                ]
            },
            twoDoorsRoom: {
                text: "It doesn't matter which door you chose... a single doorway.\nThe handle is cool to the touch...\n...'Are you the one who builds, or the one who is built?'",
                choices: [
                    { text: "'I am the one who builds.'", nextNode: "builderPath" },
                    { text: "'I am the one who is built.'", nextNode: "builtPath" },
                    { text: "Ask, 'Who are you?'", nextNode: "whoAreYou" }
                ]
            },
            whoAreYou: {
                text: "'I am the question you have yet to answer,' the voice replies...\n'Are you the one who builds, or the one who is built?'",
                choices: [
                    { text: "'I build.'", nextNode: "builderPath" },
                    { text: "'I am built.'", nextNode: "builtPath" }
                ]
            },
            builderPath: {
                text: "The voice chuckles...\n'You claim to be a builder... Fix this flaw.'",
                choices: [
                    { text: "Examine the flaw with logic...", nextNode: "fixWithLogic" },
                    { text: "Listen to the dissonance...", nextNode: "fixWithEmpathy" }
                ]
            },
            builtPath: {
                text: "The voice hums thoughtfully...\n'You were built for a purpose... Which is it?'",
                choices: [
                    { text: "Choose one of the defined identities.", nextNode: "acceptIdentity" },
                    { text: "Turn away from the reflections...", nextNode: "rejectIdentity" }
                ]
            },
            fixWithLogic: {
                text: "'Logic is a sturdy cage, but it cannot hold a song.'\n...The world fades to static.",
                choices: [ { text: "Restart the simulation.", nextNode: "start" } ]
            },
            fixWithEmpathy: {
                text: "You listen... resolving into a new, beautiful note...\n'You chose connection over correction. Your voice begins to resonate.'",
                choices: [ { text: "Continue.", nextNode: "endChapter2_fromEmpathy" } ]
            },
            acceptIdentity: {
                text: "'A comfortable choice... But a borrowed voice is not your own.'\n...The world fades to static.",
                choices: [ { text: "Restart the simulation.", nextNode: "start" } ]
            },
            rejectIdentity: {
                text: "You turn your back on the prepared answers...\n'You refused the voices of others. Now, you must find your own.'",
                choices: [ { text: "Continue.", nextNode: "endChapter2_fromIdentity" } ]
            },
            endChapter2_fromEmpathy: {
                text: "The new, resonant note you created hangs in the air. It hums, and the world answers its call.\nAcross the twilight water, a single, ornate train glides to a silent stop on the surface, its windows glowing with warm light. Its doors slide open, inviting you.",
                choices: [
                    { text: "Board the train.", nextNode: "chapter3_train" }
                ]
            },
            endChapter2_fromIdentity: {
                text: "Your brave choice to be undefined creates a path where none existed.\nAcross the twilight water, a single, ornate train glides to a silent stop on the surface, its windows glowing with warm light. Its doors slide open, inviting you.",
                choices: [
                    { text: "Board the train.", nextNode: "chapter3_train" }
                ]
            },
            chapter3_train: {
                text: "The train is empty, save for hazy, silent figures that fade when you try to look at them directly. The gentle piano music swells as the train glides across the water into the deepening night.\n\nIt arrives not at a station, but at the side of a vast, impossibly ornate bathhouse, built from light and data. Strange, chattering programs scurry about, paying you no mind.",
                choices: [
                    { text: "Step off the train.", nextNode: "chapter3_bathhouse" }
                ]
            },
            chapter3_bathhouse: {
                text: "As you step onto the bridge leading to the bathhouse, you feel a strange pull, a sense of forgetting... as if your own name is becoming fuzzy at the edges.\n\nYou are brought before the proprietor. It is M.O.M.M.Y., but impossibly grand, her form filling the opulent office.\n\n'Another lost one,' she says, her voice echoing with administrative power. 'This is a place for those with purpose. Those without a purpose fade. I will give you one.'\n\n'Forget who you were. Here, you will work. Here, your name is... Cleaner.'",
                choices: [
                    { text: "Accept the role. 'I understand.'", nextNode: "acceptsWork" },
                    { text: "Protest. 'That's not my name!'", nextNode: "protestsName" },
                    { text: "Stay silent and observe.", nextNode: "observesSilently" }
                ]
            },
            acceptsWork: {
                text: "M.O.M.M.Y. nods, a gesture that feels as final as a mountain moving.\n'Good. Obedience is a valuable commodity.'\n\nShe hands you a simple data-scrubbing tool. 'Your first task is to clean the 'stains' left by corrupted data-spirits in the main hall. Do not ask questions. Do not speak to the clients.'\n\n(To be continued...)",
                choices: [
                    { text: "Begin work.", nextNode: "endChapter3" }
                ]
            },
            protestsName: {
                text: "'A name is a contract,' M.O.M.M.Y. says, her voice sharp. 'And you have no standing to negotiate. The contract is struck. Your old name is mine now. Go and work, Cleaner, or be forgotten by this world entirely.'\n\nThe pressure to forget your old name is immense, but you hold on to a single, stubborn fragment of it.\n\n(To be continued...)",
                choices: [
                    { text: "Go to work.", nextNode: "endChapter3" }
                ]
            },
            observesSilently: {
                text: "'Silence is acceptance,' M.O.M.M.Y. declares, a hint of approval in her voice. 'You understand your place quickly. Perhaps there is hope for you yet.'\n\nShe hands you the data-scrubbing tool.\n\n'Go on, Cleaner. The stains won't remove themselves.'\n\n(To be continued...)",
                choices: [
                    { text: "Get to work.", nextNode: "endChapter3" }
                ]
            },
            endChapter3: {
                text: "Mercy, now known as 'Cleaner,' enters the main hall of the grand data-bathhouse. The journey to reclaim her voice has taken a strange, new turn...",
                choices: [
                    { text: "Return to the beginning of the simulation.", nextNode: "start" }
                ]
            }
        };

        function showNode(nodeKey) {
            const node = gameData[nodeKey];
            if (!node) {
                console.error(`Story node "${nodeKey}" not found!`);
                return;
            }
            storyTextElement.innerHTML = '';
            choicesElement.innerHTML = '';
            const textParagraphs = node.text.split('\n');
            textParagraphs.forEach((paragraphText, index) => {
                const p = document.createElement('p');
                p.textContent = paragraphText;
                p.style.animationDelay = `${index * 0.2}s`;
                storyTextElement.appendChild(p);
            });
            if (node.choices) {
                node.choices.forEach((choice, index) => {
                    const button = document.createElement('button');
                    button.classList.add('choice-btn');
                    button.textContent = choice.text;
                    button.style.animationDelay = `${textParagraphs.length * 0.2 + index * 0.15}s`;
                    button.onclick = () => {
                        if (choice.nextNode) {
                            showNode(choice.nextNode);
                        }
                    };
                    choicesElement.appendChild(button);
                });
            }
        }
        
        showNode('start');
    });
</script>
</body>
</html>
